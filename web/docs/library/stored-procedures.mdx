---
id: stored-procedures
title: 'Stored Procedures'
description: 'How to use stored procedures (rpc) with Supabase'
---

import Collapsable from '../../src/components/Collapsable'
import CommonFilters from '../common/CommonFilters'
import CommonResponses from '../common/_CommonResponses.mdx'
import CustomCodeBlock from '../../src/components/CustomCodeBlock'
import {
  storedSingleJs,
  storedBulkJs,
  storedReadingJs,
  storedFilterJs,
  storedNotJs,
  storedMatchJs,
  storedOvaJs,
  storedOvrJs,
} from './examples/stored'

You can call stored procedures as a "Remote Procedure Call".

That's a fancy way of saying that you can put some logic into your database then call it from anywhere.
It's especially useful when the logic rarely changes - like password resets and updates.

Here, we have three stored procedures that will act as our examples:

`echo_city` : Takes in objects containing a city name and returns that name.

`echo_all_cities` : Returns all rows in the table **Cities**.

`echo_all_countries` : Returns all rows in the table **Countries**. 

### Single call

<CustomCodeBlock
  header="Example of invoking a stored procedure that taking in a name of a city and returning it."
  js={storedSingleJs}
  response={`{
    error: null,
    data: [
        {"echo_city": "The Shire"}
    ] 
} 
  `}
/>

### Bulk call

This example would call a the same stored procedure above (twice), but it will also wait to receive the response only when all the calls have completed:

<CustomCodeBlock
  header="Example of invoking the same stored procedure multiple times within one call."
  js={storedBulkJs}
  response={`{
    error: null,
    data: [
        {"echo_city": "The Shire"},
        {"echo_city": "Mordor"}
    ] 
} 
  `}
/>

### Reading data

This example shows how to call a stored function that returns a table type response:

<CustomCodeBlock
  header="Example of invoking the same stored procedure multiple times within one call."
  js={storedReadingJs}
  response={`{
    error: null,
    data: [
      { "name": "Rio de Janeiro", "country_id": 76 },
      { "name": "Beijing", "country_id": 156 },
      { "name": "Paris", "country_id": 250 },
      { "name": "Auckland", "country_id": 554 },
      { "name": "Lagos", "country_id": 556 },
      { "name": "San Francisco", "country_id": 840 }
    ]
} 
  `}
/>

## Reference

### `rpc()`

```js
supabase.rpc(functionName, functionParameters)
```

#### `functionName: string`

Name of stored function in the database.

#### `functionParameters: { object? | array? }`

Parameters to be passed to the stored function.

---

## Filtering

### `filter()`

<CustomCodeBlock
  header="Shows how to use filter( ) with rpc( )"
  js={storedFilterJs}
  response={`{
    error: null,
    data: [
    { "name": "Paris", "country_id": 250 },
  ]
}`}
/>

<br />

<CommonFilters filter="filter" />

### `not()`

<CustomCodeBlock
  header="Shows how to use not( ) with rpc( )"
  js={storedNotJs}
  response={`{
    error: null,
    data: [
    { "name": "Rio de Janeiro", "country_id": 76 },
    { "name": "Beijing", "country_id": 156 },
    { "name": "Auckland", "country_id": 554 },
    { "name": "Lagos", "country_id": 556 },
    { "name": "San Francisco", "country_id": 840 }
  ]
}`}
/>

<br />

<CommonFilters filter="not" />

### `match()`

<CustomCodeBlock
  header="Shows how to use match( ) with rpc( )"
  js={storedMatchJs}
  response={`{
    error: null,
    data: [
    { "name": "Beijing", "country_id": 156 },
  ]
}`}
/>

<br />

<CommonFilters filter="match" />


